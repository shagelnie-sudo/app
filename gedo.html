<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>البحث الذكي عن الجامعات</title>
    <style>
        /* تنسيق حاوية البحث */
        .autocomplete-container {
            position: relative;
            width: 400px;
            margin: 50px auto;
            font-family: Arial, sans-serif;
        }

        /* تنسيق مربع الكتابة */
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }

        /* تنسيق قائمة الاقتراحات */
        .suggestions-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none; /* مخفية افتراضياً */
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* تنسيق كل عنصر في القائمة */
        .suggestion-item {
            padding: 10px;
            cursor: pointer;
            text-align: right;
        }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }

        .loading {
            padding: 10px;
            color: #888;
            font-style: italic;
        }
    </style>
</head>
<body>

<div class="autocomplete-container">
    <label for="university-search">ابحث عن جامعتك:</label>
    <input type="text" id="university-search" placeholder="اكتب اسم الجامعة (مثلاً: Khartoum)..." autocomplete="off">
    <div id="suggestions" class="suggestions-list"></div>
</div>

<script>
    const searchInput = document.getElementById('university-search');
    const suggestionsBox = document.getElementById('suggestions');

    // الاستماع لحدث الكتابة
    searchInput.addEventListener('input', async (e) => {
        const query = e.target.value;

        // نبدأ البحث فقط إذا كتب المستخدم أكثر من حرفين
        if (query.length < 3) {
            suggestionsBox.style.display = 'none';
            return;
        }

        // إظهار رسالة "جاري التحميل"
        suggestionsBox.innerHTML = '<div class="loading">جاري البحث...</div>';
        suggestionsBox.style.display = 'block';

        try {
            // طلب البيانات من خدمة Hipolabs العامة
            // ملاحظة: الخدمة تدعم البحث باللغة الإنجليزية بشكل أفضل
            const response = await fetch(`http://universities.hipolabs.com/search?name=${query}`);
            const data = await response.json();

            displaySuggestions(data.slice(0, 10)); // عرض أول 10 نتائج فقط للسرعة
        } catch (error) {
            console.error('خطأ في جلب البيانات:', error);
            suggestionsBox.style.display = 'none';
        }
    });

    // وظيفة عرض الاقتراحات في القائمة
    function displaySuggestions(universities) {
        if (universities.length === 0) {
            suggestionsBox.innerHTML = '<div class="suggestion-item">لا توجد نتائج</div>';
            return;
        }

        suggestionsBox.innerHTML = ''; // مسح القائمة القديمة

        universities.forEach(uni => {
            const div = document.createElement('div');
            div.className = 'suggestion-item';
            div.textContent = uni.name;
            
            // عند الضغط على اقتراح
            div.onclick = () => {
                searchInput.value = uni.name; // ملء الحقل
                suggestionsBox.style.display = 'none'; // إخفاء القائمة
            };
            suggestionsBox.appendChild(div);
        });
    }

    // إغلاق القائمة عند النقر خارجها
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.autocomplete-container')) {
            suggestionsBox.style.display = 'none';
        }
    });
</script>

</body>
</html>
